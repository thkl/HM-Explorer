{"version":3,"file":"ccu_communication.js","sources":["src/ccu/ccu_communication.js"],"sourcesContent":["const http = require('http')\n\t\nclass CCUCommunication {\n\t\n\n    constructor(ccuip) {\n\t   this.ccuIp = ccuip\n\t}\n\t\n\t\n\tsendRegaCommand(script,callback) {\n\t\tvar that = this\n\t\tvar options = {\n\t\t\thost: this.ccuIp,\n\t\t\tport: 8181,\n\t\t\tpath: '/tclrega.exe',\n\t\t\tmethod: 'POST',\n\t\t\theaders: {\n\t\t\t\t'Content-Type': 'application/x-www-form-urlencoded',\n\t\t\t\t'Content-Length': Buffer.byteLength(script)\n\t\t\t}\n\t\t}\n\t\t\n\t\tconsole.log('CCU at Rega Command :%s',script);\n\t\n\t\tvar request = http.request(options, function(response) {\n\t\tvar data = '';\n\t\n\t\tresponse.setEncoding(\"binary\");\n\n\t\n\t\tresponse.on('data', function(chunk) {\n      \t  data += chunk.toString();\n      \t});\n      \n\t  \tresponse.on('end', function() {\n     \t   var pos = data.lastIndexOf('<xml><exec>')\n\t \t   var tx = (data.substring(0, pos))\n\t \t   var vars = data.substr(pos)\n\t \t   console.log('CCU Rega Response :%s',tx)\n\t \t   \tcallback(tx,vars);\n\t \t   });\n\n\t\t}).on('error', function(e) {\n\t      console.error(e)\n\t\t});\n\n\t\trequest.write(script);\n\t\trequest.end();\n\t}\n}\n\nmodule.exports = CCUCommunication;\n"],"names":[],"mappings":";;AAAA,MAAM,IAAI,GAAG,OAAO,CAAC,MAAM,EAAC;;AAE5B,MAAM,gBAAgB,CAAC;;;IAGnB,WAAW,CAAC,KAAK,EAAE;IACnB,IAAI,CAAC,KAAK,GAAG,MAAK;EACpB;;;CAGD,eAAe,CAAC,MAAM,CAAC,QAAQ,EAAE;EAChC,IAAI,IAAI,GAAG,KAAI;EACf,IAAI,OAAO,GAAG;GACb,IAAI,EAAE,IAAI,CAAC,KAAK;GAChB,IAAI,EAAE,IAAI;GACV,IAAI,EAAE,cAAc;GACpB,MAAM,EAAE,MAAM;GACd,OAAO,EAAE;IACR,cAAc,EAAE,mCAAmC;IACnD,gBAAgB,EAAE,MAAM,CAAC,UAAU,CAAC,MAAM,CAAC;IAC3C;IACD;;EAED,OAAO,CAAC,GAAG,CAAC,yBAAyB,CAAC,MAAM,CAAC,CAAC;;EAE9C,IAAI,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE,SAAS,QAAQ,EAAE;EACvD,IAAI,IAAI,GAAG,EAAE,CAAC;;EAEd,QAAQ,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC;;;EAG/B,QAAQ,CAAC,EAAE,CAAC,MAAM,EAAE,SAAS,KAAK,EAAE;SAC7B,IAAI,IAAI,KAAK,CAAC,QAAQ,EAAE,CAAC;QAC1B,CAAC,CAAC;;IAEN,QAAQ,CAAC,EAAE,CAAC,KAAK,EAAE,WAAW;SACzB,IAAI,GAAG,GAAG,IAAI,CAAC,WAAW,CAAC,aAAa,EAAC;MAC5C,IAAI,EAAE,IAAI,IAAI,CAAC,SAAS,CAAC,CAAC,EAAE,GAAG,CAAC,EAAC;MACjC,IAAI,IAAI,GAAG,IAAI,CAAC,MAAM,CAAC,GAAG,EAAC;MAC3B,OAAO,CAAC,GAAG,CAAC,uBAAuB,CAAC,EAAE,EAAC;OACtC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC,CAAC;OAClB,CAAC,CAAC;;GAEN,CAAC,CAAC,EAAE,CAAC,OAAO,EAAE,SAAS,CAAC,EAAE;OACtB,OAAO,CAAC,KAAK,CAAC,CAAC,EAAC;GACpB,CAAC,CAAC;;EAEH,OAAO,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;EACtB,OAAO,CAAC,GAAG,EAAE,CAAC;EACd;CACD;;AAED,MAAM,CAAC,OAAO,GAAG,gBAAgB,CAAC"}